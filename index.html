<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>Lab 1 - Nature of Science</title>

    <!-- Optional shared styles (kept for your project structure) -->
    <link rel="stylesheet" href="shared/styles/common.css" />
    <link rel="stylesheet" href="shared/styles/lab-styles.css" />

    <style>
      :root {
        --indigo: #667eea;
        --indigo-dark: #5a67d8;
        --purple: #764ba2;
        --google-blue: #4285f4;
        --surface: #f0f4ff;
        --surface-2: #e8f0fe;
        --ink-900: #1d263b;
        --ink-800: #23335a;
        --ink-700: #3a4a7a;
        --ink-600: #4d5c8e;
        --ink-500: #6a76a8;
        --danger: #dc2626;
        --radius: 12px;

        /* Mobile-first typography */
        --fs-h1: clamp(1.25rem, 2.2vw + 1rem, 1.75rem);
        --fs-h2: clamp(1.05rem, 1.8vw + 0.9rem, 1.25rem);
        --fs-body: clamp(0.95rem, 0.7vw + 0.8rem, 1rem);
        --fs-btn: clamp(0.95rem, 0.7vw + 0.8rem, 1rem);

        --pad-card: clamp(14px, 2vw, 20px);
        --pad-header-y: 14px;
        --hit-area: 44px; /* touch target minimum */
      }

      /* Page chrome */
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial,
          sans-serif;
        color: var(--ink-700);
        background: #fff;
        font-size: var(--fs-body);
        line-height: 1.5;
        -webkit-tap-highlight-color: transparent;
      }

      .container {
        max-width: 960px;
        margin: 80px auto 72px;
        padding: 0 16px;
      }

      .header h1 {
        margin: 0 0 6px 0;
        font-size: var(--fs-h1);
        color: var(--ink-100);
      }

      .header p {
        margin: 0;
        color: #c6c6c7;
        font-weight: 600;
        font-size: 0.98em;
      }

      /* Top progress bar */
      .progress-indicator {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1000;
        background: rgba(255, 255, 255, 0.98);
        backdrop-filter: saturate(120%) blur(4px);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        padding: 8px 0;
        padding-top: env(safe-area-inset-top);
      }
      .progress-bar {
        width: 100%;
        height: 8px;
        background: #e0e0e0;
        overflow: hidden;
      }
      .progress-fill {
        height: 8px;
        background: linear-gradient(
          90deg,
          var(--indigo) 0%,
          var(--purple) 100%
        );
        width: 0%;
        transition: width 0.3s ease;
        display: block;
      }

      /* Section wrapper */
      .section {
        margin: 0 0 16px 0;
      }

      /* Collapsible blocks (cards) */
      .collapsible-container {
        border-radius: 12px;
        overflow: hidden;
        margin: 0 0 16px 0;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
        background: var(--surface);
        border: 1px solid #dfe7ff;
      }

      .collapsible-header {
        margin: 0;
        padding: max(var(--pad-header-y), 12px) 48px
          max(var(--pad-header-y), 12px) var(--pad-card);
        cursor: pointer;
        user-select: none;
        position: relative;
        font-weight: 800;
        color: #1f3b82;
        background: var(--surface);
        min-height: var(--hit-area);
        display: flex;
        align-items: center;
      }
      .collapsible-header:hover {
        filter: brightness(0.98);
      }
      .collapsible-header::after {
        content: "▼";
        position: absolute;
        right: 16px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 0.95em;
        color: #6a6a6a;
        transition: transform 0.2s ease;
      }
      .collapsible-header.is-collapsed::after {
        transform: translateY(-50%) rotate(-90deg);
      }

      .stripe-blue {
        border-left: 4px solid var(--google-blue);
      }
      .stripe-indigo {
        border-left: 4px solid var(--indigo);
      }

      .collapsible-content {
        display: block;
        background: var(--surface);
        padding: var(--pad-card);
        border-top: 1px solid #e5ecff;
      }
      .collapsible-content.is-collapsed {
        display: none;
      }

      /* Forms */
      textarea {
        width: 100%;
        max-width: 100%;
        padding: 12px 14px;
        border: 1px solid #c9d4ff;
        border-radius: 10px;
        font: 16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial,
          sans-serif; /* 16px avoids iOS zoom */
        box-sizing: border-box;
        background: #fff;
        min-height: 110px;
        resize: vertical;
      }
      .is-invalid {
        border-color: var(--danger) !important;
        background: #fef2f2 !important;
      }
      textarea:focus-visible {
        outline: 2px solid var(--indigo);
        outline-offset: 2px;
      }

      label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: var(--ink-700);
      }

      .form-group {
        margin-bottom: 16px;
      }

      /* Bottom buttons */
      .button-row {
        display: grid;
        grid-template-columns: 1fr;
        gap: 10px;
        justify-content: center;
        margin: 28px 0;
      }
      @media (min-width: 700px) {
        .button-row {
          grid-template-columns: repeat(3, minmax(220px, 1fr));
        }
      }
      .btn {
        padding: 14px 18px;
        border-radius: 12px;
        font-weight: 900;
        font-size: var(--fs-btn);
        border: none;
        cursor: pointer;
        transition: transform 0.15s ease, box-shadow 0.15s ease;
        min-height: 44px;
      }
      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.08);
      }
      .btn-primary {
        background: linear-gradient(
          135deg,
          var(--indigo) 0%,
          var(--purple) 100%
        );
        color: #fff;
      }
      .btn-ghost {
        background: #f7f7ff;
        border: 1px solid #d9dfff;
        color: #2b2c65;
      }

      .muted {
        font-size: 0.95em;
        color: #555;
        margin: 14px 0 0 0;
      }

      /* Motion preferences */
      @media (prefers-reduced-motion: reduce) {
        * {
          animation: none !important;
          transition: none !important;
        }
      }

      /* Responsive container spacing */
      @media (max-width: 900px) {
        .container {
          margin-top: 76px;
        }
      }
      @media (max-width: 700px) {
        .container {
          padding: 0 12px;
        }
        .collapsible-container {
          border-radius: 10px;
        }
      }
      @media (max-width: 480px) {
        .container {
          margin-bottom: 84px;
        }
        .collapsible-header {
          padding-left: 14px;
          padding-right: 42px;
        }
      }
    </style>
  </head>
  <body>
    <!-- progress -->
    <div class="progress-indicator">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
    </div>

    <div class="container">
      <div class="header">
        <h1>📚 Lab 1: The Nature of Science</h1>
        <p>Understanding Scientific Principles and Methods (30 Points)</p>
      </div>

      <!-- For This Lab (collapsible) -->
      <div class="section">
        <div class="collapsible-container">
          <div
            class="collapsible-header stripe-indigo"
            onclick="toggleCollapsible(this)"
            style="top: -1px"
          >
            📋 For this Lab
          </div>
          <div class="collapsible-content">
            <ol style="margin: 0; padding-left: 22px; line-height: 1.9">
              <li>Read the required chapter before beginning</li>
              <li>Answer all six questions in the text boxes provided</li>
              <li>
                Monitor your progress using the progress bar at the top of the
                page
              </li>
              <li>Your work is automatically saved as you type</li>
              <li>
                When complete, click
                <strong>"Download file for Canvas Submission"</strong>
              </li>
              <li>
                Locate <em>Lab01_NatureOfScience.txt</em> and upload it to
                Canvas
              </li>
            </ol>
            <p class="muted">
              <strong>💡 Tip:</strong> Each question requires a minimum of 20
              characters. Take your time to provide thoughtful, complete
              responses.
            </p>
          </div>
        </div>
      </div>

      <!-- Introduction -->
      <div class="section">
        <div class="collapsible-container">
          <div
            class="collapsible-header stripe-indigo"
            onclick="toggleCollapsible(this)"
          >
            📖 Introduction
          </div>
          <div class="collapsible-content">
            <p>
              This lab explores the fundamental principles of scientific inquiry
              and methodology. You'll examine the assumptions scientists make,
              how scientific knowledge is validated, and the ethical
              considerations that guide scientific research.
            </p>
            <p>
              <strong>Required Reading:</strong> Before answering the questions,
              please read the chapter:
              <a
                href="http://www.project2061.org/publications/sfaa/online/chap1.htm"
                target="_blank"
                style="color: var(--indigo); font-weight: 800"
              >
                Science for All Americans - Chapter 1
              </a>
            </p>
          </div>
        </div>
      </div>

      <!-- FORM -->
      <form id="questionForm">
        <!-- Q1 -->
        <div class="collapsible-container">
          <div
            class="collapsible-header stripe-blue"
            onclick="toggleCollapsible(this)"
          >
            Question 1: Assumptions in Science (6 pts)
          </div>
          <div class="collapsible-content">
            <div class="form-group">
              <label for="q1a"
                >Describe two of the assumptions or common beliefs shared by
                scientists? (3 pts each)</label
              >
              <textarea
                id="q1a"
                placeholder="Enter first assumption here..."
              ></textarea>
            </div>
            <div class="form-group">
              <textarea
                id="q1b"
                placeholder="Enter second assumption here..."
              ></textarea>
            </div>
          </div>
        </div>

        <!-- Q2 -->
        <div class="collapsible-container">
          <div
            class="collapsible-header stripe-blue"
            onclick="toggleCollapsible(this)"
          >
            Question 2: Scientific Method (3 pts)
          </div>
          <div class="collapsible-content">
            <div class="form-group">
              <label for="q2"
                >What are the fixed steps of science that scientists always
                follow when conducting research? (3 pts)</label
              >
              <textarea
                id="q2"
                placeholder="Enter your answer here..."
              ></textarea>
            </div>
          </div>
        </div>

        <!-- Q3 -->
        <div class="collapsible-container">
          <div
            class="collapsible-header stripe-blue"
            onclick="toggleCollapsible(this)"
          >
            Question 3: Testing Past Events (3 pts)
          </div>
          <div class="collapsible-content">
            <div class="form-group">
              <label for="q3"
                >Since scientific ideas are often validated by making
                predictions about future events, how can scientists test or
                validate ideas about events that happened in the past?</label
              >
              <textarea
                id="q3"
                placeholder="Enter your answer here..."
              ></textarea>
            </div>
          </div>
        </div>

        <!-- Q4 -->
        <div class="collapsible-container">
          <div
            class="collapsible-header stripe-blue"
            onclick="toggleCollapsible(this)"
          >
            Question 4: Minimizing Bias (6 pts)
          </div>
          <div class="collapsible-content">
            <div class="form-group">
              <label for="q4a"
                >How might a scientist introduce bias into their data
                unintentionally? (3 pts)</label
              >
              <textarea
                id="q4a"
                placeholder="Enter your answer here..."
              ></textarea>
            </div>
            <div class="form-group">
              <label for="q4b"
                >What is one strategy scientists can use to minimize bias in
                their work? (3 pts)</label
              >
              <textarea
                id="q4b"
                placeholder="Enter your answer here..."
              ></textarea>
            </div>
          </div>
        </div>

        <!-- Q5 -->
        <div class="collapsible-container">
          <div
            class="collapsible-header stripe-blue"
            onclick="toggleCollapsible(this)"
          >
            Question 5: Science and Authority (6 pts)
          </div>
          <div class="collapsible-content">
            <div class="form-group">
              <label for="q5a"
                >What does it mean to say that science is not based on
                authority? (3 pts)</label
              >
              <textarea
                id="q5a"
                placeholder="Enter your answer here..."
              ></textarea>
            </div>
            <div class="form-group">
              <label for="q5b"
                >How does this affect the way scientific knowledge is accepted
                or challenged? (3 pts)</label
              >
              <textarea
                id="q5b"
                placeholder="Enter your answer here..."
              ></textarea>
            </div>
          </div>
        </div>

        <!-- Q6 -->
        <div class="collapsible-container">
          <div
            class="collapsible-header stripe-blue"
            onclick="toggleCollapsible(this)"
          >
            Question 6: Ethical Challenges (6 pts)
          </div>
          <div class="collapsible-content">
            <div class="form-group">
              <label for="q6a"
                >Describe one of the ethical challenges faced in scientific
                research? (3 pts)</label
              >
              <textarea id="q6a" placeholder="Describe..."></textarea>
            </div>
            <div class="form-group">
              <label for="q6b"
                >How might scientists address ethical challenges in their
                research? (3 pts)</label
              >
              <textarea
                id="q6b"
                placeholder="How might scientists address ethical challenges in their research?"
              ></textarea>
            </div>
          </div>
        </div>

        <!-- Buttons -->
        <div class="button-row">
          <button type="button" class="btn btn-primary" id="downloadBtn">
            📥 Download file for Canvas Submission
          </button>
          <button type="button" class="btn btn-ghost" id="clearBtn">
            🗑️ Clear All Answers
          </button>
          <button
            type="button"
            class="btn btn-primary"
            onclick="window.location.href='mailto:JMartinelli@peru.edu?subject=Lab 1 - Question/Feedback&body=Hi Dr. M,%0D%0A%0D%0AI have a question about Lab 1:%0D%0A%0D%0A'"
          >
            ❓ Questions, concerns, feedback, or need help?
          </button>
        </div>
      </form>
    </div>

    <script>
      /* ---------- Progress ---------- */
      function updateProgress() {
        let earned = 0;
        const total = 30;
        const points = {
          q1a: 3,
          q1b: 3,
          q2: 3,
          q3: 3,
          q4a: 3,
          q4b: 3,
          q5a: 3,
          q5b: 3,
          q6a: 3,
          q6b: 3,
        };

        const fields = [
          "q1a",
          "q1b",
          "q2",
          "q3",
          "q4a",
          "q4b",
          "q5a",
          "q5b",
          "q6a",
          "q6b",
        ];

        fields.forEach((field) => {
          const answer = document.getElementById(field).value.trim();
          if (answer) earned += points[field];
        });

        document.getElementById("progressFill").style.width =
          (earned / total) * 100 + "%";
      }

      /* ---------- Auto-save ---------- */
      window.addEventListener("load", () => {
        const fields = [
          "q1a",
          "q1b",
          "q2",
          "q3",
          "q4a",
          "q4b",
          "q5a",
          "q5b",
          "q6a",
          "q6b",
        ];
        fields.forEach((field) => {
          const saved = localStorage.getItem(field);
          if (saved) document.getElementById(field).value = saved;
        });
        updateProgress();
      });

      document.querySelectorAll("textarea").forEach((textarea) => {
        textarea.addEventListener("input", function () {
          localStorage.setItem(this.id, this.value);
          updateProgress();
        });
      });

      /* ---------- Validation ---------- */
      function validateAllInputs() {
        let ok = true,
          firstBad = null;
        const empty = [],
          short = [];
        const fields = [
          "q1a",
          "q1b",
          "q2",
          "q3",
          "q4a",
          "q4b",
          "q5a",
          "q5b",
          "q6a",
          "q6b",
        ];

        fields.forEach((field) => {
          const textarea = document.getElementById(field);
          const val = textarea.value.trim();

          textarea.classList.remove("is-invalid");

          if (!val) {
            empty.push(field);
            textarea.classList.add("is-invalid");
            ok = false;
            if (!firstBad) firstBad = textarea;
          } else if (val.length < 20) {
            short.push(field);
            textarea.classList.add("is-invalid");
            ok = false;
            if (!firstBad) firstBad = textarea;
          }
        });

        if (!ok) {
          let msg = "Please complete the following before downloading:\n\n";
          if (empty.length) msg += `Empty fields: ${empty.join(", ")}\n`;
          if (short.length)
            msg += `Fields needing more detail (min 20 chars): ${short.join(
              ", "
            )}`;
          alert(msg);
          if (firstBad) {
            firstBad.scrollIntoView({ behavior: "smooth", block: "center" });
            firstBad.focus();
          }
        }
        return ok;
      }

      /* ---------- Download ---------- */
      document.getElementById("downloadBtn").addEventListener("click", () => {
        if (!validateAllInputs()) return;

        const answers = [];
        answers.push("LAB: 01");
        answers.push("TITLE: The Nature of Science");
        answers.push("COURSE: ESCI 240");
        answers.push("DATE: " + new Date().toISOString());
        answers.push("TOTAL_POINTS: 30");
        answers.push("=".repeat(70));
        answers.push("");

        // Q1
        answers.push("[QUESTION_1]");
        answers.push("POINTS: 6");
        answers.push("TYPE: split");
        answers.push("PROMPT: List two assumptions in science.");
        answers.push("");
        answers.push("[PART_A]");
        answers.push(document.getElementById("q1a").value.trim());
        answers.push("[/PART_A]");
        answers.push("");
        answers.push("[PART_B]");
        answers.push(document.getElementById("q1b").value.trim());
        answers.push("[/PART_B]");
        answers.push("[/QUESTION_1]");
        answers.push("");

        // Q2
        answers.push("[QUESTION_2]");
        answers.push("POINTS: 3");
        answers.push("TYPE: essay");
        answers.push(
          "PROMPT: What are the fixed steps of science that scientists always follow?"
        );
        answers.push("");
        answers.push("[ANSWER]");
        answers.push(document.getElementById("q2").value.trim());
        answers.push("[/ANSWER]");
        answers.push("[/QUESTION_2]");
        answers.push("");

        // Q3
        answers.push("[QUESTION_3]");
        answers.push("POINTS: 3");
        answers.push("TYPE: essay");
        answers.push(
          "PROMPT: How can scientists test or validate ideas about events that happened in the past?"
        );
        answers.push("");
        answers.push("[ANSWER]");
        answers.push(document.getElementById("q3").value.trim());
        answers.push("[/ANSWER]");
        answers.push("[/QUESTION_3]");
        answers.push("");

        // Q4
        answers.push("[QUESTION_4]");
        answers.push("POINTS: 6");
        answers.push("TYPE: split");
        answers.push("PROMPT: Bias in Science");
        answers.push("");
        answers.push("[PART_A]");
        answers.push(
          "How might a scientist introduce bias into their data unintentionally?"
        );
        answers.push("");
        answers.push(document.getElementById("q4a").value.trim());
        answers.push("[/PART_A]");
        answers.push("");
        answers.push("[PART_B]");
        answers.push(
          "What is one strategy scientists can use to minimize bias in their work?"
        );
        answers.push("");
        answers.push(document.getElementById("q4b").value.trim());
        answers.push("[/PART_B]");
        answers.push("[/QUESTION_4]");
        answers.push("");

        // Q5
        answers.push("[QUESTION_5]");
        answers.push("POINTS: 6");
        answers.push("TYPE: split");
        answers.push("PROMPT: Science and Authority");
        answers.push("");
        answers.push("[PART_A]");
        answers.push(
          "What does it mean to say that science is not based on authority?"
        );
        answers.push("");
        answers.push(document.getElementById("q5a").value.trim());
        answers.push("[/PART_A]");
        answers.push("");
        answers.push("[PART_B]");
        answers.push(
          "How does this affect the way scientific knowledge is accepted or challenged?"
        );
        answers.push("");
        answers.push(document.getElementById("q5b").value.trim());
        answers.push("[/PART_B]");
        answers.push("[/QUESTION_5]");
        answers.push("");

        // Q6
        answers.push("[QUESTION_6]");
        answers.push("POINTS: 6");
        answers.push("TYPE: split");
        answers.push("PROMPT: Ethical Challenges");
        answers.push("");
        answers.push("[PART_A]");
        answers.push("Ethical Challenge:");
        answers.push("");
        answers.push(document.getElementById("q6a").value.trim());
        answers.push("[/PART_A]");
        answers.push("");
        answers.push("[PART_B]");
        answers.push("How to address:");
        answers.push("");
        answers.push(document.getElementById("q6b").value.trim());
        answers.push("[/PART_B]");
        answers.push("[/QUESTION_6]");
        answers.push("");

        answers.push("=".repeat(70));
        answers.push("END OF SUBMISSION");

        const blob = new Blob([answers.join("\n")], { type: "text/plain" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "Lab01_NatureOfScience.txt";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        alert("✅ Assignment downloaded successfully!");
      });

      /* ---------- Clear ---------- */
      document.getElementById("clearBtn").addEventListener("click", () => {
        if (
          confirm(
            "Are you sure you want to clear all fields? This cannot be undone."
          )
        ) {
          const fields = [
            "q1a",
            "q1b",
            "q2",
            "q3",
            "q4a",
            "q4b",
            "q5a",
            "q5b",
            "q6a",
            "q6b",
          ];
          fields.forEach((field) => {
            document.getElementById(field).value = "";
            localStorage.removeItem(field);
          });
          updateProgress();
          alert("🗑️ All fields have been cleared.");
        }
      });

      /* ---------- Collapsibles ---------- */
      function toggleCollapsible(header) {
        const content = header.nextElementSibling;
        const collapsed = content.classList.toggle("is-collapsed");
        header.classList.toggle("is-collapsed", collapsed);
      }

      // Default: everything OPEN
      document.querySelectorAll(".collapsible-header").forEach((h) => {
        const startClosed = false;
        if (startClosed) {
          h.classList.add("is-collapsed");
          const c = h.nextElementSibling;
          if (c) c.classList.add("is-collapsed");
        }
      });

      // Initialize progress
      updateProgress();
    </script>
  </body>
</html>
